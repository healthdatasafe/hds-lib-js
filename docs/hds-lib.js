var HDSLib;(()=>{var e={196:(e,t,r)=>{const n=r(831);function s(e,t){if(e===t)return e;const r=[e,t].sort();if(r.includes("manage"))return"manage";if("contribute"===r[0])return"contribute";if("writeOnly"===r[1])return"contribute";throw new Error(`Invalid level found level1: ${e}, level2 ${t}`)}function a(e){const t=Reflect.ownKeys(e);for(const r of t){const t=e[r];(t&&"object"==typeof t||"function"==typeof t)&&a(t)}return Object.freeze(e)}function o(e,t){if(e)for(const r of e){if(t[r.id])throw new Error(`Duplicate streamId "${r.id}" for strean ${JSON.stringify(r)}`);t[r.id]=r,o(r.children,t)}}e.exports=class{#e;#t;#r;#n;#s;constructor(e){this.#e=e,this.#r={},this.#n={},this.#s={}}async load(){const e=await fetch(this.#e),t=await e.text(),r=JSON.parse(t);this.#t=r,function(e,t){for(const[r,n]of Object.entries(e)){n.key=r;const e=[];n.eventType?e.push(n.eventType):e.push(...Object.keys(n.variations.eventType));for(const r of e){const e=n.streamId+":"+r;if(t[e])throw new Error(`Duplicate streamId + eventType "${e}" for item ${JSON.stringify(n)}`);t[e]=n}}}(this.#t.items,this.#n),o(this.#t.streams,this.#s),a(this.#t)}itemDefForKey(e,t=!0){if(this.#r[e])return this.#r[e];const r=this.#t.items[e];if(!r){if(t)throw new Error("Cannot find item definition with key: "+e);return null}return this.#r[e]=new n(e,r),this.#r[e]}itemDefForEvent(e,t=!0){const r=[];for(const t of e.streamIds){const n=t+":"+e.type,s=this.#n[n];s&&r.push(s)}if(0===r.length){if(t)throw new Error("Cannot find definition for event: "+JSON.stringify(e));return null}if(r.length>1)throw new Error(`Found multiple matching definitions "${r.map((e=>e.key)).join(", ")}" for event: ${JSON.stringify(e)}`);return this.itemDefForKey(r[0].key,t)}streamsGetNecessaryListForItemKeys(e){const t=[],r=new Map;for(const n of e){const e=this.itemDefForKey(n),s=this.streamGetParentsIds(e.data.streamId,!0,[e.data.streamId]);for(const e of s){if(r.has(e))continue;const n=this.streamDataGetById(e);r.set(e,!0),t.push({id:e,name:n.name,parentId:n.parentId})}}return t}streamDataGetById(e,t=!0){const r=this.#s[e];if(t&&!r)throw new Error(`Stream with id: "${e}" not found`);return r}streamGetParentsIds(e,t=!0,r=[]){const n=this.streamDataGetById(e,t);return n?(null!==n.parentId&&(r.unshift(n.parentId),this.streamGetParentsIds(n.parentId,!0,r)),r):r}authorizationForItemKeys(e,t={}){const r={defaultLevel:"read",preRequest:[],includeDefaultName:!0};Object.assign(r,t);const n={};for(const e of r.preRequest){if(!e.streamId)throw new Error(`Missing streamId in options.preRequest item: ${JSON.stringify(e)}`);if(r.includeDefaultName&&!e.defaultName){const t=this.streamDataGetById(e.streamId,!1);if(!t)throw new Error(`No "defaultName" in options.preRequest item: ${JSON.stringify(e)} and cannot find matching streams in default list`);e.defaultName=t.name}if(!r.includeDefaultName&&e.defaultName)throw new Error(`Do not include defaultName when not included explicitely on ${JSON.stringify(e)}`);e.level||(e.level=r.defaultLevel),n[e.streamId]=e}for(const t of e){const e=this.itemDefForKey(t).data.streamId;if(n[e])n[e].level=s(n[e].level,r.defaultLevel);else{const t={streamId:e,level:r.defaultLevel};if(r.includeDefaultName){const r=this.streamDataGetById(e);t.defaultName=r.name}n[e]=t}}for(const e of Object.values(n)){const t=this.streamGetParentsIds(e.streamId,!1);for(const r of t){const t=n[r];t&&(a=t.level,o=e.level,a===o||"manage"===a||"contribute"===a&&"manage"!==o)&&delete n[e.streamId]}}var a,o;return Object.values(n)}}},831:e=>{e.exports=class{#a;#o;constructor(e,t){this.#o=e,this.#a=t}get eventTypes(){return this.#a.eventType?[this.#a.eventType]:Object.keys(this.#a.variations.eventType)}get key(){return this.#o}get data(){return this.#a}}}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{HDSModel:()=>e});const e=r(196)})(),HDSLib=n})();
//# sourceMappingURL=hds-lib.js.map